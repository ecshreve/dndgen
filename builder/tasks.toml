[[task]]
  id = "dev"
  description = "Start the dev server"
  dependencies = ["gqlserver", "frontend"]
  type = "long"
  cmd = """
    echo "Starting the dev server..."
  """

[[task]]
  id = "gqlserver"
  description = "Start the gql server"
  watch = ["server/**/*.go"]
  dependencies = ["entgen", "gqlgen"]
  type = "short"
  cmd = """
    echo "Starting the gql server..."
    go run -mod=mod ./server/main.go
  """

[[task]]
  id = "frontend"
  description = "Start the frontend"
  triggers = ["gqlserver"]
  type = "short"
  cmd = """
    echo "Starting the frontend..."
    cd frontend && npm start
  """

[[task]]
  id = "entgen"
  description = "Generate ent schema"
  type = "short"
  watch = ["ent/schema/*.go", "gqlgen.yml"]
  cmd = """
    echo "Running ent generation with entc DIRECTLY..."
    go run -mod=mod ./ent/entc.go
  """

[[task]]
  id = "gqlgen"
  description = "Generate with gqlgen"
  triggers = ["entgen"]
  type = "short"
  cmd = """
    echo "Generating with gqlgen..."
    go run -mod=mod github.com/99designs/gqlgen generate
  """


[[task]]
  id = "describe"
  description = "Describe the schema"
  type = "short"
  cmd = """
    echo "Describing the schema..."
    go run -mod=mod entgo.io/ent/cmd/ent describe ./ent/schema > ./entschema.md
  """