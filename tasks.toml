[[task]]
  id = "test"
  description = "Run all go tests"
  type = "short"
  cmd = "go test -v ./..."


[[task]]
  id = "gen"
  description = "Generate everything"
  type = "short"
  dependencies = ["internal/popper/gen"]
  watch = ["ent/schema/*.go", "ent/entc.go", "gqlgen.yml"]
  cmd = """
    echo "Running ent generation with go generate..."
    go generate ./ent/...
  """

[[task]]
  id = "migrate"
  description = "Run ent migration"
  type = "group"
  dependencies = ["ent/migrate/gen"]

[[task]]
  id = "serve"
  description = "Run gqlserver"
  type = "long"
  triggers = ["gen"]
  cmd = "go run -mod=mod cmd/dndgen/main.go"

[[task]]
  id = "dev"
  description = "Run dev server"
  type = "long"
  triggers = ["gen"]
  cmd = """
    echo "Running dev server..."
    sleep 100
  """
